(()=>{"use strict";(()=>{const e=window.location.search,t=new URLSearchParams(e);if(!t.has("tab")||"custom-post-types"!==t.get("tab"))return;const o=()=>{document.querySelector("#addNewButton").addEventListener("click",(function(){m(),r(this)})),[...document.querySelectorAll(".inlineEditButton")].forEach((e=>{e.addEventListener("click",(function(){m(),n(this)}))}))},r=()=>{const e=document.querySelector("#inlineEditTemplate").content.cloneNode(!0),t=document.querySelector("#customPostsTable");e.querySelector("legend").innerHTML="New Custom Post Type",t.querySelector("tbody").prepend(e),t.querySelector("form").setAttribute("data-type-form","new"),l(t.querySelector("#editRow")),u(document.querySelector("#customPostsTable #editRow #name_singular"))},n=e=>{const t=document.querySelector("#inlineEditTemplate").content.cloneNode(!0),o=document.querySelector("#customPostsTable"),r=JSON.parse(sessionStorage.getItem("bigupCPTOption")),n=e.getAttribute("data-post-type");if(s(r,"post_type",n)){const e=r[n];for(let[o,r]of Object.entries(e))t.getElementById(o).value=r;t.querySelector("#hiddenRow").setAttribute("id","hiddenRow-"+n),t.querySelector("#editRow").setAttribute("id","editRow-"+n),t.querySelector("input#post_type").disabled=!0;const s=document.getElementById(n);s.after(t),s.style.display="none",o.querySelector("form").setAttribute("data-type-form","edit"),l(document.querySelector("#editRow-"+n))}else alert("Error! "+n+" not found in session storage. Please alert plugin maintainer.")},s=(e,t,o)=>{let r=!1;return Object.keys(e).forEach((n=>{o===e[n][t]&&(r=!0)})),r},l=e=>{p(e),g.observe(e),c(e.querySelector("#cancelButton")),a(e.querySelector("#name_singular")),a(e.querySelector("#name_plural")),i(e.querySelector("#submitButton"))},c=e=>{e.addEventListener("click",(function(){m()}))},a=e=>{e.addEventListener("keyup",(function(){const t=e.value,o=new RegExp(e.getAttribute("pattern"),"ug");let r=t.match(o);const n="This field can only contain alphanumeric characters, spaces and hyphens.";if(!Array.isArray(r))return e.value="",void y(e,n);{const e=r.join("");r=e}t.length!==r.length&&y(e,n),e.value=d(r)}))},u=e=>{e.addEventListener("change",(function(){const t=e.closest("form").querySelector("#post_type"),o=e.value.toLowerCase().replace(/ /g,"-").substring(0,20);t.value=o}))},i=e=>{e.addEventListener("click",(function(){const t=e.closest("form"),o=t.getAttribute("data-type-form");if(t.reportValidity()&&"new"===o){const e=JSON.parse(sessionStorage.getItem("bigupCPTOption")),o=t.querySelector("#post_type");let r=o.value;const n=t.querySelector("#name_singular").value;let l=1;for(;s(e,"post_type",r);){const e=r.replace(/-\d+$/g,"");let o=e.substring(0,18);if(r=e+"-"+l,console.log(o),l++,10===l)return void y(t.querySelector("#name_singular"),"Post key already exists. Please choose a unique name.")}if(o.value=r,s(e,"name_singular",n))return void y(t.querySelector("#name_singular"),"Post name already exists. Please choose a unique name.")}e.closest("form").submit()}))},d=e=>e.replace(/--+/g,"-").replace(/  +/g," ").trimStart().replace(/\s+$/g," "),y=(e,t)=>{if(1==!!e.closest("label").querySelector(".inputMessage"))return;const o=document.createElement("div"),r=document.createTextNode(t);o.appendChild(r),o.classList.add("inputMessage"),e.after(o);const n=setTimeout((()=>{o.remove(),clearTimeout(n)}),5e3)},m=()=>{[...document.querySelectorAll(".customPostTypeRow")].forEach((e=>{e.style.display="table-row"})),[...document.querySelectorAll(".editActive")].forEach((e=>{g.unobserve(e),e.remove()}))},p=e=>{const t=e.closest("table").querySelector("tr").querySelectorAll("th").length;e.querySelector("td").setAttribute("colspan",t)},g=new ResizeObserver((e=>{p(e[0].target)})),S=setInterval((()=>{"complete"===document.readyState&&(clearInterval(S),o())}),100)})()})();