(()=>{"use strict";(()=>{const e=window.location.search,t=new URLSearchParams(e);if(!t.has("tab")||"custom-post-types"!==t.get("tab"))return;const o=()=>{document.querySelector("#addNewButton").addEventListener("click",(function(){y(),r(this)})),[...document.querySelectorAll(".inlineEditButton")].forEach((e=>{e.addEventListener("click",(function(){y(),n(this)}))}))},r=()=>{const e=document.querySelector("#inlineEditTemplate").content.cloneNode(!0),t=document.querySelector("#customPostsTable");e.querySelector("legend").innerHTML="New Custom Post Type",t.querySelector("tbody").prepend(e),t.querySelector("form").setAttribute("data-type-form","new"),s(t.querySelector("#editRow")),a(document.querySelector("#customPostsTable #editRow #name_singular"))},n=e=>{const t=document.querySelector("#inlineEditTemplate").content.cloneNode(!0),o=document.querySelector("#customPostsTable"),r=JSON.parse(sessionStorage.getItem("bigupCPTOption")),n=e.getAttribute("data-post-type");if(n in r){const e=r[n];for(let[o,r]of Object.entries(e))t.getElementById(o).value=r;t.querySelector("#hiddenRow").setAttribute("id","hiddenRow-"+n),t.querySelector("#editRow").setAttribute("id","editRow-"+n),t.querySelector("input#post_type").disabled=!0;const c=document.getElementById(n);c.after(t),c.style.display="none",o.querySelector("form").setAttribute("data-type-form","edit"),s(document.querySelector("#editRow-"+n))}else alert("Error! "+n+" not found in session storage. Please alert plugin maintainer.")},s=e=>{m(e),p.observe(e),c(e.querySelector("#cancelButton")),l(e.querySelector("#name_singular")),l(e.querySelector("#name_plural")),i(e.querySelector("#submitButton"))},c=e=>{e.addEventListener("click",(function(){y()}))},l=e=>{e.addEventListener("keyup",(function(){const t=e.value,o=new RegExp(e.getAttribute("pattern"),"ug");let r=t.match(o);const n="This field can only contain alphanumeric characters, spaces and hyphens.";if(!Array.isArray(r))return e.value="",void d(e,n);{const e=r.join("");r=e}t.length!==r.length&&d(e,n),e.value=u(r)}))},a=e=>{e.addEventListener("change",(function(){const t=e.closest("form").querySelector("#post_type"),o=e.value.toLowerCase().replace(/ /g,"-").substring(0,20);t.value=o}))},i=e=>{e.addEventListener("click",(function(){const t=e.closest("form"),o=t.getAttribute("data-type-form");if(t.reportValidity()&&"new"===o){const e=JSON.parse(sessionStorage.getItem("bigupCPTOption")),o=t.querySelector("#post_type");let r=o.value,n=1;for(;r in e;){let e=r.substring(0,18);if(r=e+"-"+n,console.log(e),n++,10===n)return void d(t.querySelector("#name_singular"),"Post key already exists. Please choose a unique name.")}o.value=r}e.closest("form").submit()}))},u=e=>e.replace(/--+/g,"-").replace(/  +/g," ").trimStart().replace(/\s+$/g," "),d=(e,t)=>{if(1==!!e.closest("label").querySelector(".inputMessage"))return;const o=document.createElement("div"),r=document.createTextNode(t);o.appendChild(r),o.classList.add("inputMessage"),e.after(o);const n=setTimeout((()=>{o.remove(),clearTimeout(n)}),5e3)},y=()=>{[...document.querySelectorAll(".customPostTypeRow")].forEach((e=>{e.style.display="table-row"})),[...document.querySelectorAll(".editActive")].forEach((e=>{p.unobserve(e),e.remove()}))},m=e=>{const t=e.closest("table").querySelector("tr").querySelectorAll("th").length;e.querySelector("td").setAttribute("colspan",t)},p=new ResizeObserver((e=>{m(e[0].target)})),S=setInterval((()=>{"complete"===document.readyState&&(clearInterval(S),o())}),100)})()})();