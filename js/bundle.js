(()=>{"use strict";(()=>{const e=window.location.search,t=new URLSearchParams(e);if(!t.has("tab")||"custom-post-types"!==t.get("tab"))return;const r=()=>{document.querySelector("#addNewButton").addEventListener("click",(function(){p(),o()})),[...document.querySelectorAll(".inlineEditButton")].forEach((e=>{e.addEventListener("click",(function(){p(),n(this)}))})),[...document.querySelectorAll(".inlineDeleteButton")].forEach((e=>{e.addEventListener("click",(function(){l(this)}))}))},o=()=>{const e=document.querySelector("#inlineFormTemplate").content.cloneNode(!0),t=document.querySelector("#customPostsTable");e.querySelector("legend").innerHTML="New Custom Post Type",t.querySelector("tbody").prepend(e),t.querySelector("form").setAttribute("data-type-form","new"),s(t.querySelector("#editRow")),i(document.querySelector("#customPostsTable #editRow #name_singular"))},n=e=>{const t=document.querySelector("#inlineFormTemplate").content.cloneNode(!0),r=document.querySelector("#customPostsTable"),o=JSON.parse(sessionStorage.getItem("bigupCPTOption")),n=e.getAttribute("data-post-type");if(e.setAttribute("aria-expanded","true"),a(o,"post_type",n)){const e=o[n];for(let[r,o]of Object.entries(e))t.getElementById(r).value=o;t.querySelector("#hiddenRow").setAttribute("id","hiddenRow-"+n),t.querySelector("#editRow").setAttribute("id","editRow-"+n);const l=document.getElementById(n);l.after(t),l.style.display="none";const a=r.querySelector("form");return a.setAttribute("data-type-form","edit"),s(document.querySelector("#editRow-"+n)),a}alert("Error! "+n+" not found in session storage. Please alert plugin maintainer.")},l=e=>{const t=n(e),r=t.querySelector("#submitButton"),o=t.querySelector("legend"),l=t.querySelector("#post_type"),a=t.querySelector("#name_singular").value,s=t.querySelector("#deleteFlag").content.cloneNode(!0);for(e.setAttribute("aria-expanded","true");1==!!l.nextSibling;)l.nextSibling.remove();l.after(s),o.innerHTML='Are you sure you want to delete post type "'+a+'"?',r.innerHTML="Delete",r.classList.add("delete")},a=(e,t,r)=>{if([e,t,r].includes(void 0))return!1;let o=!1;return Object.keys(e).forEach((n=>{r===e[n][t]&&(o=!0)})),o},s=e=>{S(e),g.observe(e),u(e.querySelector("#cancelButton")),c(e.querySelector("#name_singular")),c(e.querySelector("#name_plural")),d(e.querySelector("#submitButton"))},u=e=>{e.addEventListener("click",(function(){p()}))},c=e=>{e.addEventListener("keyup",(function(){const t=e.value,r=new RegExp(e.getAttribute("pattern"),"ug");let o=t.match(r);const n="This field can only contain alphanumeric characters, spaces and hyphens.";if(!Array.isArray(o))return e.value="",void m(e,n);{const e=o.join("");o=e}t.length!==o.length&&m(e,n),e.value=y(o)}))},i=e=>{e.addEventListener("change",(function(){const t=e.closest("form").querySelector("#post_type"),r=e.value.toLowerCase().replace(/ /g,"-").substring(0,20);t.value=r}))},d=e=>{e.addEventListener("click",(function(){const t=e.closest("form");if(e.classList.contains("delete"))return void t.submit();const r=t.getAttribute("data-type-form"),o=t.querySelector("#name_singular").value,n=t.querySelector("#name_plural").value,l=t.querySelector("#post_type");let s=l.value;const u=t.reportValidity(),c=JSON.parse(sessionStorage.getItem("bigupCPTOption"));let i=!1;if(1==!!c){if(u&&"new"===r){let e=1;for(;a(c,"post_type",s);){const r=s.replace(/-\d$/g,"");s=r.substring(0,18)+"-"+e,10===e&&(m(t.querySelector("#name_singular"),"Post key duplication. Please choose a unique name."),i=!0),e++}}if(a(c,"name_singular",o)&&"edit"!==r&&(m(t.querySelector("#name_singular"),"Post singular name already exists. Please choose a unique name."),i=!0),a(c,"name_plural",n)&&"edit"!==r&&(m(t.querySelector("#name_plural"),"Post plural name already exists. Please choose a unique name."),i=!0),!0===i)return}l.value=s,t.submit()}))},y=e=>e.replace(/--+/g,"-").replace(/  +/g," ").trimStart().replace(/\s+$/g," "),m=(e,t)=>{if(1==!!e.closest("label").querySelector(".inputMessage"))return;const r=document.createElement("div"),o=document.createTextNode(t);r.appendChild(o),r.classList.add("inputMessage"),e.after(r);const n=setTimeout((()=>{r.remove(),clearTimeout(n)}),5e3)},p=()=>{[...document.querySelectorAll(".customPostTypeRow")].forEach((e=>{e.style.display="table-row"})),[...document.querySelectorAll(".inlineEditButton")].forEach((e=>{e.setAttribute("aria-expanded","false")})),[...document.querySelectorAll(".inlineDeleteButton")].forEach((e=>{e.setAttribute("aria-expanded","false")})),[...document.querySelectorAll(".editActive")].forEach((e=>{g.unobserve(e),e.remove()}))},S=e=>{const t=e.closest("table").querySelector("tr").querySelectorAll("th").length;e.querySelector("td").setAttribute("colspan",t)},g=new ResizeObserver((e=>{S(e[0].target)})),q=setInterval((()=>{"complete"===document.readyState&&(clearInterval(q),r())}),100)})()})();