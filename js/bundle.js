(()=>{"use strict";(()=>{const e=window.location.search,t=new URLSearchParams(e);if(!t.has("tab")||"custom-post-types"!==t.get("tab"))return;const r=JSON.parse(sessionStorage.getItem("bigupCPTOption"));Object.keys(r).forEach((e=>{console.log(r[e].post_type)}));const o=()=>{document.querySelector("#addNewButton").addEventListener("click",(function(){p(),n(this)})),[...document.querySelectorAll(".inlineEditButton")].forEach((e=>{e.addEventListener("click",(function(){p(),s(this)}))}))},n=()=>{const e=document.querySelector("#inlineFormTemplate").content.cloneNode(!0),t=document.querySelector("#customPostsTable");e.querySelector("legend").innerHTML="New Custom Post Type",t.querySelector("tbody").prepend(e),t.querySelector("form").setAttribute("data-type-form","new"),a(t.querySelector("#editRow")),i(document.querySelector("#customPostsTable #editRow #name_singular"))},s=e=>{const t=document.querySelector("#inlineFormTemplate").content.cloneNode(!0),r=document.querySelector("#customPostsTable"),o=JSON.parse(sessionStorage.getItem("bigupCPTOption")),n=e.getAttribute("data-post-type");if(l(o,"post_type",n)){const e=o[n];for(let[r,o]of Object.entries(e))t.getElementById(r).value=o;t.querySelector("#hiddenRow").setAttribute("id","hiddenRow-"+n),t.querySelector("#editRow").setAttribute("id","editRow-"+n),t.querySelector("input#post_type").disabled=!0;const s=document.getElementById(n);s.after(t),s.style.display="none",r.querySelector("form").setAttribute("data-type-form","edit"),a(document.querySelector("#editRow-"+n))}else alert("Error! "+n+" not found in session storage. Please alert plugin maintainer.")},l=(e,t,r)=>{if([e,t,r].includes(void 0))return!1;let o=!1;return Object.keys(e).forEach((n=>{r===e[n][t]&&(o=!0)})),o},a=e=>{g(e),S.observe(e),c(e.querySelector("#cancelButton")),u(e.querySelector("#name_singular")),u(e.querySelector("#name_plural")),d(e.querySelector("#submitButton"))},c=e=>{e.addEventListener("click",(function(){p()}))},u=e=>{e.addEventListener("keyup",(function(){const t=e.value,r=new RegExp(e.getAttribute("pattern"),"ug");let o=t.match(r);const n="This field can only contain alphanumeric characters, spaces and hyphens.";if(!Array.isArray(o))return e.value="",void y(e,n);{const e=o.join("");o=e}t.length!==o.length&&y(e,n),e.value=m(o)}))},i=e=>{e.addEventListener("change",(function(){const t=e.closest("form").querySelector("#post_type"),r=e.value.toLowerCase().replace(/ /g,"-").substring(0,20);t.value=r}))},d=e=>{e.addEventListener("click",(function(){const t=e.closest("form"),r=t.getAttribute("data-type-form"),o=t.querySelector("#name_singular").value,n=t.querySelector("#name_plural").value,s=t.querySelector("#post_type");let a=s.value;const c=t.reportValidity(),u=JSON.parse(sessionStorage.getItem("bigupCPTOption"));let i=!1;if(1==!!u){if(c&&"new"===r){let e=1;for(;l(u,"post_type",a);){const r=a.replace(/-\d$/g,"");a=r.substring(0,18)+"-"+e,10===e&&(y(t.querySelector("#name_singular"),"Post key duplication. Please choose a unique name."),i=!0),e++}}if(l(u,"name_singular",o)&&(y(t.querySelector("#name_singular"),"Post singular name already exists. Please choose a unique name."),i=!0),l(u,"name_plural",n)&&(y(t.querySelector("#name_plural"),"Post plural name already exists. Please choose a unique name."),i=!0),!0===i)return}s.value=a,e.closest("form").submit()}))},m=e=>e.replace(/--+/g,"-").replace(/  +/g," ").trimStart().replace(/\s+$/g," "),y=(e,t)=>{if(1==!!e.closest("label").querySelector(".inputMessage"))return;const r=document.createElement("div"),o=document.createTextNode(t);r.appendChild(o),r.classList.add("inputMessage"),e.after(r);const n=setTimeout((()=>{r.remove(),clearTimeout(n)}),5e3)},p=()=>{[...document.querySelectorAll(".customPostTypeRow")].forEach((e=>{e.style.display="table-row"})),[...document.querySelectorAll(".editActive")].forEach((e=>{S.unobserve(e),e.remove()}))},g=e=>{const t=e.closest("table").querySelector("tr").querySelectorAll("th").length;e.querySelector("td").setAttribute("colspan",t)},S=new ResizeObserver((e=>{g(e[0].target)})),q=setInterval((()=>{"complete"===document.readyState&&(clearInterval(q),o())}),100)})()})();